<!DOCTYPE html>
<html>
<head>
<a href="https://www.buymeacoffee.com/pnpbuddy"><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a coffee&emoji=&slug=pnphelper&button_colour=FFDD00&font_colour=000000&font_family=Arial&outline_colour=000000&coffee_colour=ffffff" /></a>
    <title>PDF Alignment Tool</title>
    <style>
        html {
            height: 100%;
        }

        body {
            min-height: 100%;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: radial-gradient(circle farthest-corner at 22.4% 21.7%, #04bde4 0%, #0253b9 100.2%);
        }

        .container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            padding: 20px;
            box-sizing: border-box;
            max-width: 800px; /* Limit container width on larger screens */
            width: 90%; /* Set container width to 90% on smaller screens */
        }

        h1 {
            color: white;
            margin-bottom: 20px;
            font-size: 48px; /* Reduce font size for smaller screens */
        }

        span {
            color: white;
            font-size: 24px; /* Reduce font size for smaller screens */
        }

        p {
            color: white;
            font-size: 24px; /* Reduce font size for smaller screens */
            margin-bottom: 20px;
        }

        label {
            display: inline-block;
            width: 100%; /* Make labels full-width on smaller screens */
            max-width: 250px; /* Limit label width on larger screens */
            color: white;
            font-size: 36px; /* Reduce font size for smaller screens */
            text-align: left; /* Adjust label alignment for smaller screens */
        }

        input[type="file"] {
            width: 100%;
	    color: white;
            height: 40px; /* Reduce input height for smaller screens */
            font-size: 24px; /* Reduce font size for smaller screens */
            box-sizing: border-box;
		margin-bottom: 20px;
        }


        input[type="number"] {
            width: 70px;
            height: 40px; /* Reduce input height for smaller screens */
            font-size: 24px; /* Reduce font size for smaller screens */
		padding: 5px;
  		border: 1px solid #ccc;
  		border-radius: 10px;
            box-sizing: border-box;
        }

input[type="radio"] {
  transform: scale(3);
  margin: 20px;
  cursor: pointer;
}

        .form-group {
            margin-bottom: 20px;
        }

        button {
            background-color: #4CAF50;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 40px; /* Reduce font size for smaller screens */
        }

        button:hover {
            background-color: #45a049;
        }

        @media screen and (max-width: 767px) {
            h1 {
                font-size: 36px;
            }

            span {
                font-size: 18px;
            }

            p {
                font-size: 18px;
            }

            label {
                font-size: 24px;
            }

            button {
                font-size: 36px;
            }
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.js"></script>
    <script>
      async function shiftPDFContent() {
        const shiftX = parseFloat(document.getElementById('shiftX').value.replace(',', '.')) * 2.83464567;
  const shiftY = parseFloat(document.getElementById('shiftY').value.replace(',', '.')) * 2.83464567;
        const shiftPages = document.querySelector('input[name="shiftPages"]:checked').value;

        const inputFile = document.getElementById('pdfFile');
        const pdfFile = inputFile.files[0];
        const originalName = pdfFile.name.split('.pdf')[0];

        const reader = new FileReader();
        reader.onload = async function() {
          const data = new Uint8Array(this.result);
          const pdfDoc = await PDFLib.PDFDocument.load(data);
          const pages = pdfDoc.getPages();

          for (let i = 0; i < pages.length; i++) {
            const page = pages[i];
            const rotation = page.getRotation().angle;

           // Convert degrees to radians
const rotationRadians = rotation * (Math.PI / 180);

// Adjust shift values based on rotation angle
const adjustedShiftX = shiftX * Math.cos(rotationRadians) - shiftY * Math.sin(rotationRadians);
const adjustedShiftY = shiftX * Math.sin(rotationRadians) + shiftY * Math.cos(rotationRadians);

            if (shiftPages === 'odd' && (i + 1) % 2 === 1) {
                // Shift the content on odd pages
                page.translateContent(adjustedShiftX, adjustedShiftY);
            } else if (shiftPages === 'even' && (i + 1) % 2 === 0) {
                // Shift the content on even pages
                page.translateContent(adjustedShiftX, adjustedShiftY);;
            }
          }

          const modifiedPDFData = await pdfDoc.save();
          const blob = new Blob([modifiedPDFData], { type: 'application/pdf' });
          await fetch('counter.php');
          const url = URL.createObjectURL(blob);
          const anchor = document.createElement('a');
          anchor.href = url;
          anchor.download = originalName + '_shifted.pdf';
          anchor.click();

          // Clean up the URL and remove the anchor element after a short delay
          setTimeout(() => {
            URL.revokeObjectURL(url);
            anchor.remove();
          }, 100);
        };
        reader.readAsArrayBuffer(pdfFile);
      }
    </script>
  </head>
<body>
<div class="container">
      <h1>PDF Alignment Tool</h1>
      <p>This tool will shift (move) all content of every odd/even page.<br>
Set the amount of millimeters you want to shift the content to the right/up.
Negative(-) numbers will shift it to the left/down instead.
        </p>
      <div class="form-group">
       <label for="pdfFile">Choose file:</label><br>
       <input type="file" id="pdfFile" accept="application/pdf">
     </div>
     <div class="form-group">
  <label for="shiftX">Shift right:</label>
  <input type="number" id="shiftX" value="0" step="0.5"><span>mm</span>
</div>
<div class="form-group">
  <label for="shiftY">Shift up:</label>
  <input type="number" id="shiftY" value="0" step="0.5"><span>mm</span>
</div>
     <div class="form-group">
       <label>Apply shift to:</label>
<br>
       <input type="radio" id="odd" name="shiftPages" value="odd" checked>
       <label for="odd">Odd pages</label>
<br>
       <input type="radio" id="even" name="shiftPages" value="even">
       <label for="even">Even pages</label><br>
     </div>
     <button onclick="shiftPDFContent()">Create shifted PDF</button>
   </div>
 </body>
</html>
